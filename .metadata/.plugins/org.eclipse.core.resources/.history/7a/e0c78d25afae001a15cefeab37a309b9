package SWexpert;
import java.util.*;
public class Swea9280 {
	static Scanner sc = new Scanner(System.in);
	static int C;
	static int N;
	static int M;
	public static void main(String[] args) {
		C = sc.nextInt();
		
		for(int tc=1;tc<=C;tc++) {
			N = sc.nextInt();
			M = sc.nextInt();
			
			int[] price = new int[N];
			int[] carnum = new int[N];
			boolean[] park = new boolean[N];
			
			for(int i=0;i<N;i++) {
				price[i] = sc.nextInt();
			}
			int sum = 0;
			for(int i=0;i<M*2;i++) {
				
				int car = sc.nextInt();
				
				if(car >0) {
					for(int j=0;j<N;j++) {
						if(!park[j]) {
							carnum[j] = car;
							sum+= car*price[j];
							break;
						}
					}
				}else {
					for(int j=0;j<N;j++) {
						if(carnum[j] == car) {
							park[j] = false;
						}
					}
				}
			}
			
			System.out.println("#" + tc + " " + sum);
		}

	}

}
